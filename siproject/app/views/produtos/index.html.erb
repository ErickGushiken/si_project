<%= render "layouts/header" %>

<p id="notice"><%= notice %></p>

<div class="produto-index-grid pt4">
  <% @produtos.each do |produto| %>

    <div class="produto border-light">
      <div class="produto-thumb">
      <%= link_to image_tag(produto.image_url(:thumb)), produto %>
      </div>


    <div class="pa3">
      
      <p class="fw7 f4 title"><%= link_to produto.nome, produto %></p>

      <p class="f3 fw6 has-text-right pt2 valor"><%= number_to_currency(produto.valor) %></p>

      <% if current_user %>
            <% if current_user.tipo==2 %>
              <%= link_to 'Delete', produto, method: :delete, data: { confirm: "Are you sure ?" }, class: "button is-small" %>
            <% end %> 
            <% if current_user.tipo==0 %>
              <%= link_to 'Edit', edit_produto_path(produto), class: "button is-small" %>
              <%= link_to 'Delete', produto, method: :delete, data: { confirm: "Are you sure ?" }, class: "button is-small" %>
            <% end %> 
            <% if current_user.tipo==1 %>
              <p id="notice"><%= notice %></p>
              <h1> Seu Catalogo </h1>
              <% cache @produtos do %>
                <% @produtos.each do |produto| %>
                  <% cache produto do %>
                    <div class="entry">
                      <h3><%= produto.nome %></h3>
                      <%= sanitize(produto.descricao) %>
                      <div class="valor_line">
                        <span class="valor"><%= number_to_currency(produto.valor) %></span>
                        <%= button_to "Adicionar ao Carrinho", line_items_path(produto_id:produto) %>
                      </div>
                    </div>
                  <% end %>
                <% end %>
              <% end %>
            <% end %>
      <% end %>
    </div>
  </div>
  <% end %>
</div>